
# London Stage PDFs


In order to display a PDF for each event on the website, we had to chop up the original PDFs by date and then key those to each event in the database. This folder contains the scripts and intermediate JSON files used in those processes.


## The Process

Initially we ran the PDF2JSON.js script on each PDF in the /source folder. This generated a JSON output file from the OCR of each PDF that we then stored in the /dates folder. Each of these JSON files was then manually reviewed and fixed. Once reviewed, we ran each JSON file through the SplitPDF.js script which split each PDF into date-sized chunks. Most dates only spanned part of one page, but there were several dates that spanned more than one page. The PDFs were split up accordingly. This script also tweaked the JSON and output new files that we stored in the /pages folder. These new files were then passed through ImportToDB.js which imported the split up PDF filename into the Events table for each event. 

### Zero-Dates
There ended up being several event dates that were missed or ignored in the above process. Many of these dates were referred to as 'zero-dates' because they only had a month or a year assigned to them, but no date. To resolve this, a report was run on the database to pull out all events that were missing PDF information and was saved as zero-dates.json. This file was then run through the ZeroDates.js script to add a 'page' array property to each object. Once complete, the file was then run through the ZeroDatesFilenames.js script which calculated out the filename for each object and this new JSON was output to zero-dates-filenames.json. The new JSON file was then run through ZDPDFSplit.js to split out the relevant PDFs into date-sized chunks (same function as SplitPDF.js above). This same JSON file was then also run through the ImportToDB.js script to import the missing information into the database. 


## Setup


### Requirements
You'll need Node.js installed on your machine to run the JS files.
Simply run 'npm install' on the project to install dependencies. 


### Explanation of Files
A few quick explanations for some of the files/folders in the project.
  ``` bash
- /dates
        JSON output from the PDF2JSON.js script. Each file lines up with a PDF from the /source folder.
        These files were manually reviewed and fixed after their initial creation, afterwhich they were
        used by the SplitPDF.js script.


- /pages
        JSON output from the SplitPDF.js script. Each file lines up with a PDF from the /source folder.
        These files are used by the ImportToDB.js script.


- /source
        PDFs of The London Stage.


- /ImportToDB.js
        Imports the filenames listed in the /pages files into the Events table. You will need to put your
        database user/pass in the file for this to work. 


- /PDF2JSON.js
        Reads a PDF in /source and creates a JSON output file containing date objects for each date found
        on each page. These output files are stored in /dates.


- /SplitPDF.js
        Splits out the /source PDFs into individual pages or sets of pages depending on what each date
        requires. Outputs a new JSON file for each PDF and those files are stored in the /pages folder.


- /ZDPDFSplit.js
        This is used after ZeroDates.js and ZeroDatesFilenames.js have been run. Works the same as
        SplitPDF.js, but tracks each PDF and changes between them as needed.
        After this is done, run ImportToDB.js on the zero-dates-filenames.json file to update the
        database.


- /ZeroDatesFilenames.js
        After running ZeroDates.js, this script is used to generate the filename for each date object.
        Then, run ZDPDFSplit.js to split out the PDF.


- /zero-dates-filenames.json
        Generated by ZeroDatesFilenames.js. Contains zero-date objects, now with related filenames for
        later database entry.


- /ZeroDates.js
        This script is simply used to add a page array to each object in the zero-dates.json file.


- /zero-dates.json
        There were several events that were missing PDF info, often due to being a zero-date (a month
        without a date or a year without a month/date).
        A quick SQL script was used to find all of these in the database and output them to this file. 
        
```
